<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Asif Mehedi | Batten Institute" />


<title>Beyond Spreadsheets: R for MBAs</title>

<script src="index_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<script src="index_files/navigation-1.1/codefolding.js"></script>
<link href="index_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="index_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="index_files/readthedown-0.1/readthedown.css" rel="stylesheet" />
<script src="index_files/readthedown-0.1/readthedown.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>


<div id="content" data-toggle="wy-nav-shift">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<nav id="nav-top" role="navigation" aria-label="top navigation">
    <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
</nav>

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
</ul>
</div>

<div id="header">
<h1 class="title">Beyond Spreadsheets: R for MBAs</h1>
<h1 class="subtitle">Exploring New York City‚Äôs Airbnb Listings</h1>
</div>


<div id="table-of-contents">
    <h2><a href="#content">Beyond Spreadsheets: R for MBAs</a></h2>
    <div id="text-table-of-contents">
      <ul>
      <li><a href="#goals">Goals</a></li>
      <li><a href="#rstudio">RStudio</a><ul>
      <li><a href="#r-notebook">R Notebook</a></li>
      </ul></li>
      <li><a href="#the-data">The Data</a></li>
      <li><a href="#the-context">The Context</a><ul>
      <li><a href="#airbnb">Airbnb</a></li>
      <li><a href="#new-york-city">New York City</a></li>
      </ul></li>
      <li><a href="#prepare-to-analyze">Prepare to Analyze</a><ul>
      <li><a href="#install-and-load-packages">Install and load packages</a></li>
      <li><a href="#load-and-prepare-data">Load and prepare data</a></li>
      </ul></li>
      <li><a href="#detour-programming-concepts">Detour: Programming Concepts</a><ul>
      <li><a href="#variables-programming">Variables (programming)</a></li>
      <li><a href="#data-structures">Data structures</a></li>
      <li><a href="#data-types">Data types</a></li>
      <li><a href="#functions">Functions</a></li>
      </ul></li>
      <li><a href="#back-to-analysis">Back to Analysis</a><ul>
      <li><a href="#missing-values">Missing values</a></li>
      <li><a href="#a-set-of-verbs">A Set of Verbs</a></li>
      </ul></li>
      <li><a href="#explore-visually">Explore Visually</a></li>
      <li><a href="#keep-learning">Keep Learning</a><ul>
      <li><a href="#download-cheatsheets">Download Cheatsheets</a></li>
      </ul></li>
      </ul>
    </div>
</div>

<div id="main">
<div id="goals" class="section level1">
<h1>Goals</h1>
<ul>
<li>Get a feel for what R is all about</li>
<li>Get familiar with an analysis workflow that goes beyond Excel</li>
<li>Learn some powerful techniques of exploring a large-ish dataset</li>
</ul>
<p>We‚Äôll do these by taking a close look at some interesting data: the Airbnb listings in New York City as of August 2019.</p>
<p>It‚Äôs okay if you can‚Äôt start using these techniques right away after the workshop. To be comfortable with a tool like R takes some time and practice. Your exposure today to these tools and techniques will likely show you R‚Äôs possibilities and motivate you to keep learning.I suggest some learning resources at the end of this document.</p>
</div>
<div id="rstudio" class="section level1">
<h1>RStudio</h1>
<p>RStudio is a free program that makes writing R code much more enjoyable and efficient. Strictly speaking, you don‚Äôt need it to write R code, but I highly recommend you use RStudio.</p>
<p>It has four main panes. This one ‚Äî assuming you‚Äôre reading this on RStudio ‚Äî is the ‚Äúcode editor‚Äù (also known as ‚Äúscript editor‚Äù and ‚Äúsource editor‚Äù). This is where we‚Äôll spend most of our time. I‚Äôll describe the other panes later.</p>
<div id="r-notebook" class="section level2">
<h2>R Notebook</h2>
<p>Before starting our analysis, let‚Äôs understand how this document works. (I‚Äôm assuming you‚Äôre reading this on RStudio.)</p>
<p>This document is an <em>R Notebook</em>. An R Notebook contains commentary interspersed with code chunks. The code chunks can be run (executed) independently and interactively. The output will appear below the code chunk. R Notebooks are easy to convert to well-formatted final documents as a pdf file, a webpage, or an MS Word file. <a href="http://rmarkdown.rstudio.com/r_notebooks.html">More here</a></p>
<p>What you‚Äôre reading is <em>commentary</em> and what you see below is the container for a code chunk.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># The code goes here</span></a></code></pre></div>
<p>To run a code chunk, click on the little triangle at the right edge of the code chunk. Or, use the keyboard shortcut <strong>CTRL + SHIFT + ENTER</strong> (Windows) or <strong>CMD + SHIFT + ENTER</strong> (Mac).</p>
<p>üèè Run the chunk below and see what happens.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">a &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">print</span>(a)</a></code></pre></div>
<pre><code>## [1] 12</code></pre>
<p>Do you see some output below the code chunk? This way you can immediately see the result of your code as you work on your analysis.</p>
<p>(Do you know what‚Äôs going on in the code above? We‚Äôll talk about variables and assignments later.)</p>
<p>Feel free to add your commentary and code anywhere in this document. You can always download the <a href="https://github.com/asifm/workshops/archive/R-intro-2019.zip">unmodified version</a>.</p>
<p>To write your own code chunk, look for the <strong>insert</strong> button above and then select <strong>R</strong>. Or, use the keyboard shortcut <strong>CTRL + ALT + I</strong> (Windows) or <strong>CMD + OPTION + I</strong> (Mac).</p>
<p>üèè Place the cursor below and create a container for writing code. Now write some code and run it. For example, find the result of <code>3543 / 562</code>.</p>
</div>
</div>
<div id="the-data" class="section level1">
<h1>The Data</h1>
<p>The dataset contains almost all the Airbnb listings in NYC as of August 2019. The data came from <a href="http://insideairbnb.com/get-the-data.html">Inside Airbnb</a>.</p>
<p>It‚Äôs always a good idea to approach a new dataset with a few basic questions. Some examples:</p>
<ul>
<li>What kind of data is here? What are the variables? How many observations?</li>
<li>Who collected these data? How? Why?</li>
<li>How accurate are these data?</li>
<li>How complete are these data? Are there too many missing values?</li>
<li>Do I have the legal rights to use these data? Under what conditions?</li>
</ul>
<p><a href="http://insideairbnb.com/behind.html">Here‚Äôs some background information</a> that may answer some of these questions.</p>
<p>Let‚Äôs take a look at the data. Open the Excel file in the <code>data</code> folder. Browse around a bit.</p>
<p>ü§î Can you explain what each column is about?</p>
<p>ü§î What‚Äôs the first thing you‚Äôd like to find out from these data?</p>
<p>ü§î What do you think about the quality of the data?</p>
</div>
<div id="the-context" class="section level1">
<h1>The Context</h1>
<p>Data analysis happens within a broader context. Usually, there‚Äôs an overarching business, policy, or scientific question that one would like to answer. Often, though, the question is not very clear. Whatever the case, you need to approach the data with curiosity about the larger context.</p>
<p>The more you understand the context of the data, the better will be your questions and hypotheses guiding your analysis.</p>
<p>For our dataset, we should have a good understanding of the business model of Airbnb as well as the economy and geography of NYC.</p>
<p>ü§î Is there anything else we should know about?</p>
<div id="airbnb" class="section level2">
<h2>Airbnb</h2>
<p>ü§î How much do I need to know about Airbnb and its business? Is my personal experience with Airbnb enough? What if I don‚Äôt have any personal experience?</p>
<ul>
<li><a href="https://www.wikiwand.com/en/Airbnb#/How_it_works">How Airbnb works</a></li>
<li><a href="https://www.airbnb.com/rooms/2168594?s=frffIXWS">Example of an Airbnb listing</a></li>
</ul>
</div>
<div id="new-york-city" class="section level2">
<h2>New York City</h2>
<p>We can start with a map of the city.</p>
<p><img src="https://i.imgur.com/se7fTYT.png" /></p>
<p>The map gives us an idea about the relative size and location of the five boroughs of NYC.</p>
<p>ü§î What else do we know about these boroughs? What about the neighborhoods within the boroughs?</p>
</div>
</div>
<div id="prepare-to-analyze" class="section level1">
<h1>Prepare to Analyze</h1>
<div id="install-and-load-packages" class="section level2">
<h2>Install and load packages</h2>
<p>We‚Äôll first install a few packages that we‚Äôll need at different stages of the analysis. This may take a minute or two.</p>
<p>The symbol <code>#</code> at the start of a line means the line is a comment. These lines are left alone (that is, not executed) when you run a code chunk. You can use comments either to explain your code within a code chunk or to temporarily prevent a line of code from executing.</p>
<p>If the lines containing <code>install.packages</code> are ‚Äúcommented out,‚Äù please remove the <code>#</code>s before running the code chunk.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># For loading data</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># install.packages(&quot;readr&quot;)</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># # For data manipulation (we&#39;ll spend most time with this one)</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co"># install.packages(&quot;dplyr&quot;)</span></a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co"># # For visualization</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co"># install.packages(&quot;ggplot2&quot;)</span></a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co"># # To work with date and time</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co"># install.packages(&quot;lubridate&quot;)</span></a></code></pre></div>
<p>And then we load the packages for our current R session. After these packages are successfully loaded, all the functions in these packages will be available for our use.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">library</span>(lubridate)</a></code></pre></div>
</div>
<div id="load-and-prepare-data" class="section level2">
<h2>Load and prepare data</h2>
<p>We‚Äôll use the function <code>read_csv</code> ‚Äî which comes from the package <code>readr</code> ‚Äî to load data from a file and convert the data into a dataframe. A dataframe is a tabular data structure, with columns as variables and rows as observations. In this case, the dataframe looks exactly as it does in the CSV file.</p>
<p>ü§î What‚Äôs a CSV file?</p>
<p>ü§î What are some other formats used for storing data?</p>
<p>ü§î What can I do if my data is in a format I‚Äôm not familiar with? [hint: Google, package, function]</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/airbnb_nyc_data.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   listing_url = col_character(),
##   name = col_character(),
##   description = col_character(),
##   host_name = col_character(),
##   host_since = col_character(),
##   host_response_time = col_character(),
##   host_response_rate = col_character(),
##   host_is_superhost = col_logical(),
##   host_verifications = col_character(),
##   host_identity_verified = col_logical(),
##   neighborhood = col_character(),
##   borough = col_character(),
##   property_type = col_character(),
##   bed_type = col_character(),
##   calendar_updated = col_character(),
##   has_availability = col_logical(),
##   instant_bookable = col_logical(),
##   is_business_travel_ready = col_logical(),
##   cancellation_policy = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre><code>## Warning: 16 parsing failures.
##   row     col               expected    actual                       file
##  2197 zipcode a double               NY 10011  &#39;data/airbnb_nyc_data.csv&#39;
##  2330 zipcode a double               NY 10011  &#39;data/airbnb_nyc_data.csv&#39;
## 20559 zipcode no trailing characters 
## 11249 &#39;data/airbnb_nyc_data.csv&#39;
## 23281 zipcode no trailing characters -2308     &#39;data/airbnb_nyc_data.csv&#39;
## 25894 zipcode no trailing characters -3233     &#39;data/airbnb_nyc_data.csv&#39;
## ..... ....... ...................... ......... ..........................
## See problems(...) for more details.</code></pre>
<p>The first thing to check is whether the data have been successfully loaded and assigned to the variable (here <code>df</code>). We don‚Äôt see any error ‚Äî which is a good sign. We can also see the variable <code>df</code> in the environment pane (usually to the right of this code editor pane ‚Äì click on ‚ÄúEnvironment‚Äù if hidden).</p>
<p>The next thing to check is whether <code>read_csv</code> was able to correctly infer the data type of each variable.</p>
<p>For a better glimpse, use the function <code>glimpse</code>.</p>
<p>ü§î How am I supposed to know what functions are out there?</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">glimpse</span>(df)</a></code></pre></div>
<pre><code>## Observations: 37,762
## Variables: 44
## $ id                          &lt;dbl&gt; 1925519, 4244476, 6031895, 6887405...
## $ listing_url                 &lt;chr&gt; &quot;https://www.airbnb.com/rooms/1925...
## $ name                        &lt;chr&gt; &quot;Sublet: $490/Wk&quot;, &quot;Sunny and Funk...
## $ description                 &lt;chr&gt; &quot;$490/week. Huge 1 bedroom / 2bdr ...
## $ host_id                     &lt;dbl&gt; 2765870, 782008, 6396863, 11081099...
## $ host_name                   &lt;chr&gt; &quot;Amarie2131&quot;, &quot;Lori&quot;, &quot;Tianhui&quot;, &quot;...
## $ host_since                  &lt;chr&gt; &quot;6/27/2012&quot;, &quot;7/5/2011&quot;, &quot;5/14/201...
## $ host_response_time          &lt;chr&gt; &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;,...
## $ host_response_rate          &lt;chr&gt; &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;,...
## $ host_is_superhost           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE,...
## $ host_total_listings_count   &lt;dbl&gt; 1, 1, 1, 2, 5, 1, 1, 1, 1, 1, 1, 3...
## $ host_verifications          &lt;chr&gt; &quot;[&#39;email&#39;, &#39;phone&#39;, &#39;facebook&#39;, &#39;r...
## $ host_identity_verified      &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, TRUE, TRU...
## $ neighborhood                &lt;chr&gt; &quot;Lower East Side&quot;, &quot;Greenpoint&quot;, &quot;...
## $ borough                     &lt;chr&gt; &quot;Manhattan&quot;, &quot;Brooklyn&quot;, &quot;Manhatta...
## $ zipcode                     &lt;dbl&gt; 10002, 11222, 10019, 10031, 11206,...
## $ property_type               &lt;chr&gt; &quot;Apartment&quot;, &quot;Apartment&quot;, &quot;Apartme...
## $ accommodates                &lt;dbl&gt; 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 4...
## $ bathrooms                   &lt;dbl&gt; 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0,...
## $ bedrooms                    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1...
## $ beds                        &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2...
## $ bed_type                    &lt;chr&gt; &quot;Real Bed&quot;, &quot;Real Bed&quot;, &quot;Airbed&quot;, ...
## $ price                       &lt;dbl&gt; 80, 75, 60, 50, 50, 50, 85, 80, 35...
## $ security_deposit            &lt;dbl&gt; NA, NA, 400, 700, NA, NA, NA, NA, ...
## $ cleaning_fee                &lt;dbl&gt; NA, NA, NA, 25, NA, NA, NA, NA, NA...
## $ guests_included             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ extra_people                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ minimum_nights              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 2...
## $ calendar_updated            &lt;chr&gt; &quot;43 months ago&quot;, &quot;24 months ago&quot;, ...
## $ has_availability            &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE...
## $ availability_365            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 87, 0, ...
## $ number_of_reviews           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ number_of_reviews_ltm       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ review_scores_rating        &lt;dbl&gt; 20, 20, 20, 20, 20, 20, 20, 20, 20...
## $ review_scores_accuracy      &lt;dbl&gt; 6, 2, 6, 6, 2, 2, 2, NA, 2, 8, 10,...
## $ review_scores_cleanliness   &lt;dbl&gt; 2, 2, 2, 2, 2, 8, 2, NA, 2, 8, 2, ...
## $ review_scores_checkin       &lt;dbl&gt; 6, 10, 2, 10, 8, 4, 8, NA, 2, 4, 1...
## $ review_scores_communication &lt;dbl&gt; 6, 10, 8, 10, 8, 6, 6, NA, 6, 2, 1...
## $ review_scores_location      &lt;dbl&gt; 10, 10, 10, 8, 8, 8, 10, NA, 4, 4,...
## $ review_scores_value         &lt;dbl&gt; 6, 2, 4, 4, 2, 4, 2, NA, 4, 4, 4, ...
## $ instant_bookable            &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, ...
## $ is_business_travel_ready    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE,...
## $ cancellation_policy         &lt;chr&gt; &quot;flexible&quot;, &quot;flexible&quot;, &quot;moderate&quot;...
## $ reviews_per_month           &lt;dbl&gt; 0.02, 0.02, 0.02, 0.02, 0.02, 0.02...</code></pre>
<p>What you see within the angular brackets <code>&lt;...&gt;</code> next to each column name is the data type of that column.</p>
<p>But what are data types? And why are they important?</p>
<p>What exactly is a variable in programming?</p>
<p>What is a function?</p>
<p>Let‚Äôs take a detour.</p>
</div>
</div>
<div id="detour-programming-concepts" class="section level1">
<h1>Detour: Programming Concepts</h1>
<div id="variables-programming" class="section level2">
<h2>Variables (programming)</h2>
<p>In programming, a variable stores some value. Our code can then reference the name of the variable to do something with it.</p>
<p>We use a left-facing arrow to assign a value to a variable. The arrow looks like this: <code>&lt;-</code> (the less-than sign followed by a hyphen).</p>
<p>For example, in the code below, <code>foo</code> and <code>bar</code> are variable names. We assigned the values <code>43</code> and <code>"kitten"</code> to <code>foo</code> and <code>bar</code> respectively. You can read them as <code>foo</code> gets <code>43</code> and <code>bar</code> gets <code>"kitten"</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">foo &lt;-<span class="st"> </span><span class="dv">43</span></a>
<a class="sourceLine" id="cb12-2" title="2">bar &lt;-<span class="st"> &quot;kitten&quot;</span></a></code></pre></div>
<p>Let‚Äôs do something with these variables.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># Multiply foo by 10</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">print</span>(foo <span class="op">*</span><span class="st"> </span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [1] 430</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># Just see the value of bar</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">print</span>(bar)</a></code></pre></div>
<pre><code>## [1] &quot;kitten&quot;</code></pre>
<p>Important: The word <code>variable</code> can be ambiguous. You may be familiar with the term as used in statistics. For example, if some data is about people, some variables could be age, sex, income and address. The names of the columns of a dataframe are variables in the statistical sense. Usually, the context would clarify which meaning is intended.</p>
<p>Tip: Give short descriptive names to your variables. This will make the code easy to follow.</p>
<p>üèè A room is 11 yards long and 7.5 yards wide. Assign these values to <code>width</code> and <code>length</code> variables and then calculate the <code>area</code> of the room. You can, of course, give different names to these variables if you wish.</p>
</div>
<div id="data-structures" class="section level2">
<h2>Data structures</h2>
<p><code>vector</code>, <code>list</code>, <code>matrix</code>, and <code>dataframe</code> are some of the main data-structures for storing data in R.</p>
<p>Think of a vector as simply a sequence of data. For example, a column in a data table is a vector. This is how you create a vector: <code>c(element1, element2, element3, ...)</code></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">print</span>(vec)</a></code></pre></div>
<pre><code>## [1]  3  5 10 20</code></pre>
</div>
<div id="data-types" class="section level2">
<h2>Data types</h2>
<p>We also need to know a little about data types. These are the main ones:</p>
<ul>
<li>Integer: such as 2, 543, 90.</li>
<li>Double: numbers other than integers, such as 4.56, 1/33. Doubles are always approximations.</li>
<li>Character: a sequence of letters, numbers, punctuation, etc., such as ‚Äúrainbow‚Äù, ‚Äú34265‚Äù. Character data are always written within quotes, either single or double (we‚Äôll always use double for consistency).</li>
<li>Logical: data that can take on one of only two values ‚Äî TRUE or FALSE.</li>
</ul>
<p>ü§î Why is ‚Äú34265‚Äù above of the type character? What‚Äôs a real-world example of this kind of data?</p>
<p>There are some other important data types: - <code>factor</code>, for categorical variables (here ‚Äúvariable‚Äù in statistical sense). A categorical variable is one that can take on a limited, fixed number of values. - <code>date-time</code> and <code>date</code></p>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>You‚Äôre familiar with Excel functions, such as <code>sum()</code> or <code>average()</code>. The concept of functions in a programming language is no different. You give some values (called parameters) to a function. The function does something with the values and returns a new value. So <code>sum(3, 6, 1)</code> returns 10. Here <code>sum</code> is the name of the function, 3, 6, 1 are parameters, and 10 is the returned value.</p>
<p>Most of the times, you‚Äôll use functions written by other people. But it‚Äôs not too difficult to write your own functions. Here‚Äôs a simple one. All it does is add 10 to a given number and then return the total.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="cf">function</span>(num){</a>
<a class="sourceLine" id="cb19-2" title="2">  new_value &lt;-<span class="st">  </span>num <span class="op">+</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb19-3" title="3">  new_value</a>
<a class="sourceLine" id="cb19-4" title="4">}</a></code></pre></div>
<pre><code>## function(num){
##   new_value &lt;-  num + 10
##   new_value
## }</code></pre>
<p>But we can‚Äôt really use the function yet. We need to give it a name. Let‚Äôs go with <code>add10</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">add10 &lt;-<span class="st"> </span><span class="cf">function</span>(num){</a>
<a class="sourceLine" id="cb21-2" title="2">  new_value &lt;-<span class="st">  </span>num <span class="op">+</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb21-3" title="3">  new_value</a>
<a class="sourceLine" id="cb21-4" title="4">}</a></code></pre></div>
<p>Now we can use this function whenever we need to add 10 to a number. (This is, of course, a toy example. In practice, a function would do much more work.)</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># Add 10 to 35</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">add10</span>(<span class="dv">35</span>)</a></code></pre></div>
<pre><code>## [1] 45</code></pre>
<p>We won‚Äôt write any function today. Rather, we‚Äôll use functions that R ‚Äî and the packages we loaded ‚Äî make available to us. Here‚Äôs an example: the <code>mean</code> function, which comes preloaded in R.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># First let&#39;s create a vector</span></a>
<a class="sourceLine" id="cb24-2" title="2">vec2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">23</span>, <span class="dv">53</span>, <span class="dv">11</span>, <span class="dv">34</span>, <span class="dv">87</span>, <span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">66</span>, <span class="dv">9</span>, <span class="dv">87</span>, <span class="dv">110</span>, <span class="dv">20</span>, <span class="dv">33</span>, <span class="dv">54</span>, <span class="dv">43</span>, <span class="dv">76</span>)</a>
<a class="sourceLine" id="cb24-3" title="3"></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="co"># Let&#39;s calculate the mean of the vector</span></a>
<a class="sourceLine" id="cb24-5" title="5">calculated_mean &lt;-<span class="st"> </span><span class="kw">mean</span>(vec2)</a>
<a class="sourceLine" id="cb24-6" title="6"></a>
<a class="sourceLine" id="cb24-7" title="7"><span class="co"># Then output it with some text description</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="kw">message</span>(<span class="st">&quot;The mean of the vector vec2 is &quot;</span>, calculated_mean)</a></code></pre></div>
<pre><code>## The mean of the vector vec2 is 48.4117647058824</code></pre>
<p>üèè Calculate the sum, median, and standard deviation (hint: sd) of the vector vec2.</p>
<p>üèè Let‚Äôs load some new data. You‚Äôll see there are two other data files in the <code>data</code> folder: <code>babynames_2018.csv</code> and <code>babynames_1880.csv</code>. They contain the top 1000 names of babies born in 2018 and 1880, respectively. Load the 2018 data to a dataframe (hint: <code>read_csv</code>). Assign the dataframe to a variable named <code>df_babynames</code> (You can give a variable any name you like ‚Äî but it‚Äôs always a good idea to give variables meaningful, consistent names).</p>
<p>üèè Now take a look at the dataframe‚Äôs data types. (hint: <code>glimpse</code>)</p>
</div>
</div>
<div id="back-to-analysis" class="section level1">
<h1>Back to Analysis</h1>
<p>Let‚Äôs take another look at the data types of our dataframe.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">glimpse</span>(df)</a></code></pre></div>
<pre><code>## Observations: 37,762
## Variables: 44
## $ id                          &lt;dbl&gt; 1925519, 4244476, 6031895, 6887405...
## $ listing_url                 &lt;chr&gt; &quot;https://www.airbnb.com/rooms/1925...
## $ name                        &lt;chr&gt; &quot;Sublet: $490/Wk&quot;, &quot;Sunny and Funk...
## $ description                 &lt;chr&gt; &quot;$490/week. Huge 1 bedroom / 2bdr ...
## $ host_id                     &lt;dbl&gt; 2765870, 782008, 6396863, 11081099...
## $ host_name                   &lt;chr&gt; &quot;Amarie2131&quot;, &quot;Lori&quot;, &quot;Tianhui&quot;, &quot;...
## $ host_since                  &lt;chr&gt; &quot;6/27/2012&quot;, &quot;7/5/2011&quot;, &quot;5/14/201...
## $ host_response_time          &lt;chr&gt; &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;,...
## $ host_response_rate          &lt;chr&gt; &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;, &quot;N/A&quot;,...
## $ host_is_superhost           &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE,...
## $ host_total_listings_count   &lt;dbl&gt; 1, 1, 1, 2, 5, 1, 1, 1, 1, 1, 1, 3...
## $ host_verifications          &lt;chr&gt; &quot;[&#39;email&#39;, &#39;phone&#39;, &#39;facebook&#39;, &#39;r...
## $ host_identity_verified      &lt;lgl&gt; TRUE, TRUE, FALSE, TRUE, TRUE, TRU...
## $ neighborhood                &lt;chr&gt; &quot;Lower East Side&quot;, &quot;Greenpoint&quot;, &quot;...
## $ borough                     &lt;chr&gt; &quot;Manhattan&quot;, &quot;Brooklyn&quot;, &quot;Manhatta...
## $ zipcode                     &lt;dbl&gt; 10002, 11222, 10019, 10031, 11206,...
## $ property_type               &lt;chr&gt; &quot;Apartment&quot;, &quot;Apartment&quot;, &quot;Apartme...
## $ accommodates                &lt;dbl&gt; 1, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 4...
## $ bathrooms                   &lt;dbl&gt; 1.0, 1.0, 1.0, 1.0, 2.0, 1.0, 1.0,...
## $ bedrooms                    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1...
## $ beds                        &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 1, 2, 1, 2...
## $ bed_type                    &lt;chr&gt; &quot;Real Bed&quot;, &quot;Real Bed&quot;, &quot;Airbed&quot;, ...
## $ price                       &lt;dbl&gt; 80, 75, 60, 50, 50, 50, 85, 80, 35...
## $ security_deposit            &lt;dbl&gt; NA, NA, 400, 700, NA, NA, NA, NA, ...
## $ cleaning_fee                &lt;dbl&gt; NA, NA, NA, 25, NA, NA, NA, NA, NA...
## $ guests_included             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ extra_people                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ minimum_nights              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 7, 2...
## $ calendar_updated            &lt;chr&gt; &quot;43 months ago&quot;, &quot;24 months ago&quot;, ...
## $ has_availability            &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE...
## $ availability_365            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 87, 0, ...
## $ number_of_reviews           &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...
## $ number_of_reviews_ltm       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...
## $ review_scores_rating        &lt;dbl&gt; 20, 20, 20, 20, 20, 20, 20, 20, 20...
## $ review_scores_accuracy      &lt;dbl&gt; 6, 2, 6, 6, 2, 2, 2, NA, 2, 8, 10,...
## $ review_scores_cleanliness   &lt;dbl&gt; 2, 2, 2, 2, 2, 8, 2, NA, 2, 8, 2, ...
## $ review_scores_checkin       &lt;dbl&gt; 6, 10, 2, 10, 8, 4, 8, NA, 2, 4, 1...
## $ review_scores_communication &lt;dbl&gt; 6, 10, 8, 10, 8, 6, 6, NA, 6, 2, 1...
## $ review_scores_location      &lt;dbl&gt; 10, 10, 10, 8, 8, 8, 10, NA, 4, 4,...
## $ review_scores_value         &lt;dbl&gt; 6, 2, 4, 4, 2, 4, 2, NA, 4, 4, 4, ...
## $ instant_bookable            &lt;lgl&gt; FALSE, TRUE, FALSE, FALSE, FALSE, ...
## $ is_business_travel_ready    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE,...
## $ cancellation_policy         &lt;chr&gt; &quot;flexible&quot;, &quot;flexible&quot;, &quot;moderate&quot;...
## $ reviews_per_month           &lt;dbl&gt; 0.02, 0.02, 0.02, 0.02, 0.02, 0.02...</code></pre>
<p>Some of the data types don‚Äôt look right. Let‚Äôs correct them.</p>
<p>ü§î why is it important to have the correct data type?</p>
<p>But, first, let‚Äôs learn how to reference a column in a dataframe: first the name of the dataframe, then <code>$</code> and then the column name. For example: <code>df$cancellation_policy</code> or <code>df_babynames$name</code>.</p>
<p>To change data type, we apply the relevant function, such <code>as.character</code> or <code>as.factor</code>, to a column and then assign the output of the function (values with changed data type) to the same column.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">df<span class="op">$</span>host_id &lt;-<span class="st"> </span><span class="kw">as.character</span>(df<span class="op">$</span>host_id)</a>
<a class="sourceLine" id="cb28-2" title="2">df<span class="op">$</span>host_response_rate &lt;-<span class="st"> </span><span class="kw">as.double</span>(df<span class="op">$</span>host_response_rate)</a></code></pre></div>
<pre><code>## Warning: NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">df<span class="op">$</span>property_type &lt;-<span class="st"> </span><span class="kw">as.factor</span>(df<span class="op">$</span>property_type)</a>
<a class="sourceLine" id="cb30-2" title="2">df<span class="op">$</span>host_since &lt;-<span class="st"> </span><span class="kw">mdy</span>(df<span class="op">$</span>host_since)</a></code></pre></div>
<p>ü§î What is the rationale for each of these changes?</p>
<p>Side note: The last function <code>mdy</code> is different from the others. Normally, working with date-time in R (and in programming in general) is not simple. The <code>lubridate</code> package, which we loaded earlier, makes the job much easier. We‚Äôll not go into the details of date-times. What we did here with <code>mdy</code> is convert character data into date data. We used <code>mdy</code> because the character data were in the form month-date-year. If they were in the form, for example, year-month-date, we would‚Äôve used the function <code>ymd</code>.</p>
<p>üèè Change the data type of any other variables you think necessary.</p>
<div id="missing-values" class="section level2">
<h2>Missing values</h2>
<p>Let‚Äôs inspect our data for missing values using the function <code>summary</code>, which will give us plenty of other relevant information as well.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">summary</span>(df)</a></code></pre></div>
<pre><code>##        id           listing_url            name          
##  Min.   :    2595   Length:37762       Length:37762      
##  1st Qu.: 8775486   Class :character   Class :character  
##  Median :19047199   Mode  :character   Mode  :character  
##  Mean   :18350954                                        
##  3rd Qu.:27964916                                        
##  Max.   :37447887                                        
##                                                          
##  description          host_id           host_name        
##  Length:37762       Length:37762       Length:37762      
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character  
##                                                          
##                                                          
##                                                          
##                                                          
##    host_since         host_response_time host_response_rate
##  Min.   :2008-08-27   Length:37762       Min.   :0.00      
##  1st Qu.:2013-06-26   Class :character   1st Qu.:0.97      
##  Median :2015-03-14   Mode  :character   Median :1.00      
##  Mean   :2015-03-13                      Mean   :0.94      
##  3rd Qu.:2016-11-22                      3rd Qu.:1.00      
##  Max.   :2019-08-02                      Max.   :1.00      
##  NA&#39;s   :14                              NA&#39;s   :10601     
##  host_is_superhost host_total_listings_count host_verifications
##  Mode :logical     Min.   :   0.000          Length:37762      
##  FALSE:28654       1st Qu.:   1.000          Class :character  
##  TRUE :9094        Median :   1.000          Mode  :character  
##  NA&#39;s :14          Mean   :   7.874                            
##                    3rd Qu.:   2.000                            
##                    Max.   :1080.000                            
##                    NA&#39;s   :14                                  
##  host_identity_verified neighborhood         borough         
##  Mode :logical          Length:37762       Length:37762      
##  FALSE:18355            Class :character   Class :character  
##  TRUE :19393            Mode  :character   Mode  :character  
##  NA&#39;s :14                                                    
##                                                              
##                                                              
##                                                              
##     zipcode          property_type    accommodates      bathrooms     
##  Min.   : 7093   Apartment  :29582   Min.   : 1.000   Min.   : 0.000  
##  1st Qu.:10025   House      : 3190   1st Qu.: 2.000   1st Qu.: 1.000  
##  Median :11201   Townhouse  : 1425   Median : 2.000   Median : 1.000  
##  Mean   :10703   Loft       : 1174   Mean   : 2.901   Mean   : 1.136  
##  3rd Qu.:11221   Condominium: 1123   3rd Qu.: 4.000   3rd Qu.: 1.000  
##  Max.   :91766   Guest suite:  324   Max.   :20.000   Max.   :15.500  
##  NA&#39;s   :403     (Other)    :  944                    NA&#39;s   :44      
##     bedrooms           beds          bed_type             price      
##  Min.   : 0.000   Min.   : 0.000   Length:37762       Min.   :    0  
##  1st Qu.: 1.000   1st Qu.: 1.000   Class :character   1st Qu.:   69  
##  Median : 1.000   Median : 1.000   Mode  :character   Median :  100  
##  Mean   : 1.177   Mean   : 1.571                      Mean   :  141  
##  3rd Qu.: 1.000   3rd Qu.: 2.000                      3rd Qu.:  169  
##  Max.   :14.000   Max.   :40.000                      Max.   :10000  
##  NA&#39;s   :18       NA&#39;s   :19                                         
##  security_deposit  cleaning_fee     guests_included   extra_people   
##  Min.   :   0.0   Min.   :   0.00   Min.   : 1.000   Min.   :  0.00  
##  1st Qu.:   0.0   1st Qu.:  25.00   1st Qu.: 1.000   1st Qu.:  0.00  
##  Median : 100.0   Median :  50.00   Median : 1.000   Median : 10.00  
##  Mean   : 252.8   Mean   :  62.93   Mean   : 1.587   Mean   : 16.12  
##  3rd Qu.: 300.0   3rd Qu.:  90.00   3rd Qu.: 2.000   3rd Qu.: 25.00  
##  Max.   :5100.0   Max.   :1000.00   Max.   :16.000   Max.   :300.00  
##  NA&#39;s   :11349    NA&#39;s   :5945                                       
##  minimum_nights     calendar_updated   has_availability availability_365
##  Min.   :   1.000   Length:37762       Mode:logical     Min.   :  0.0   
##  1st Qu.:   1.000   Class :character   TRUE:37762       1st Qu.:  0.0   
##  Median :   2.000   Mode  :character                    Median : 53.0   
##  Mean   :   5.864                                       Mean   :115.5   
##  3rd Qu.:   4.000                                       3rd Qu.:237.0   
##  Max.   :1250.000                                       Max.   :365.0   
##                                                                         
##  number_of_reviews number_of_reviews_ltm review_scores_rating
##  Min.   :  1.00    Min.   :  0.00        Min.   : 20.00      
##  1st Qu.:  3.00    1st Qu.:  1.00        1st Qu.: 92.00      
##  Median : 10.00    Median :  4.00        Median : 96.00      
##  Mean   : 30.24    Mean   : 11.83        Mean   : 93.93      
##  3rd Qu.: 35.00    3rd Qu.: 17.00        3rd Qu.:100.00      
##  Max.   :639.00    Max.   :359.00        Max.   :100.00      
##                                          NA&#39;s   :4           
##  review_scores_accuracy review_scores_cleanliness review_scores_checkin
##  Min.   : 2.00          Min.   : 2.000            Min.   : 2.000       
##  1st Qu.: 9.00          1st Qu.: 9.000            1st Qu.:10.000       
##  Median :10.00          Median :10.000            Median :10.000       
##  Mean   : 9.62          Mean   : 9.278            Mean   : 9.749       
##  3rd Qu.:10.00          3rd Qu.:10.000            3rd Qu.:10.000       
##  Max.   :10.00          Max.   :10.000            Max.   :10.000       
##  NA&#39;s   :44             NA&#39;s   :28                NA&#39;s   :60           
##  review_scores_communication review_scores_location review_scores_value
##  Min.   : 2.000              Min.   : 2.000         Min.   : 2.000     
##  1st Qu.:10.000              1st Qu.: 9.000         1st Qu.: 9.000     
##  Median :10.000              Median :10.000         Median :10.000     
##  Mean   : 9.756              Mean   : 9.567         Mean   : 9.399     
##  3rd Qu.:10.000              3rd Qu.:10.000         3rd Qu.:10.000     
##  Max.   :10.000              Max.   :10.000         Max.   :10.000     
##  NA&#39;s   :38                  NA&#39;s   :65             NA&#39;s   :63         
##  instant_bookable is_business_travel_ready cancellation_policy
##  Mode :logical    Mode :logical            Length:37762       
##  FALSE:23618      FALSE:37762              Class :character   
##  TRUE :14144                               Mode  :character   
##                                                               
##                                                               
##                                                               
##                                                               
##  reviews_per_month
##  Min.   : 0.010   
##  1st Qu.: 0.200   
##  Median : 0.740   
##  Mean   : 1.394   
##  3rd Qu.: 2.060   
##  Max.   :66.610   
## </code></pre>
<p>ü§î Should we worry about missing values?</p>
<p>There are a few options for dealing with missing values.</p>
<ul>
<li>We can drop all rows that have one or more missing values.</li>
<li>Drop rows that have missing values in particular columns.</li>
<li>Replace the missing values with some other value.</li>
<li>Do nothing, but do remember to take care of them when running arithmetic operations. (explained later)</li>
</ul>
<p>In our case, we‚Äôll go with the last option.</p>
<p>ü§î Is the last option the best for our dataset? What would be a better alternative?</p>
</div>
<div id="a-set-of-verbs" class="section level2">
<h2>A Set of Verbs</h2>
<p>Finally, we‚Äôre ready to dive into the data. We‚Äôll use six functions ‚Äî think of them as six verbs ‚Äî to slice and dice the data in all kinds of ways. These functions come from the <code>dplyr</code> package. They are:</p>
<ul>
<li>filter</li>
<li>select</li>
<li>mutate</li>
<li>arrange</li>
<li>summarize</li>
<li>group_by</li>
</ul>
<p>We‚Äôll first learn these functions one by one and later we‚Äôll learn how to combine them for rich analysis.</p>
<p>For each of these functions, we provide the name of the dataframe as the first parameter. The subsequent parameters inform what the function is to do with the dataframe.</p>
<div id="verb-filter" class="section level3">
<h3>Verb: filter</h3>
<p>You use <code>filter</code>, when you want a subset of the rows based on one or more conditions. The returned rows will be those that meet the condition(s).</p>
<p>The syntax is: <code>filter(name_of_dataframe, condition1, condition2, ...)</code></p>
<p>Use these <em>logical operators</em> to create the conditions:</p>
<pre><code>&lt;       less than
&lt;=      less than or equal to
&gt;       greater than
&gt;=      greater than or equal to
==      exactly equal to
!=      not equal to
!x      Not x
x | y   x OR y
x &amp; y   x AND y</code></pre>
<p>Example: Return a dataframe with only those rows where the neighborhood is Chelsea.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">filter</span>(df, neighborhood <span class="op">==</span><span class="st"> &quot;Chelsea&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 796 x 44
##        id listing_url name  description host_id host_name host_since
##     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
##  1 2.08e7 https://ww~ Huge~ One of a k~ 6433797 Marlon    2013-05-17
##  2 3.27e7 https://ww~ Huge~ Larger tha~ 244559~ Stewart ~ 2019-02-21
##  3 3.40e7 https://ww~ Beau~ Beautiful ~ 234227~ Emma      2019-01-03
##  4 3.37e7 https://ww~ Midt~ This 158 s~ 252604~ Erin      2019-04-01
##  5 3.42e7 https://ww~ Amaz~ This wonde~ 174313~ Plamen    2018-02-20
##  6 1.87e6 https://ww~ Big ~ The big ro~ 9751988 Asuka     2013-11-01
##  7 3.27e7 https://ww~ Larg~ Looking fo~ 244559~ Stewart ~ 2019-02-21
##  8 1.37e7 https://ww~ Brig~ My light-f~ 803159~ Meghan    2016-06-27
##  9 1.95e6 https://ww~ 1BD ~ A cozy hom~ 100713~ Trevor    2013-11-17
## 10 1.91e7 https://ww~ Cozy~ Cozy Effic~ 829201~ Zach      2016-07-10
## # ... with 786 more rows, and 37 more variables: host_response_time &lt;chr&gt;,
## #   host_response_rate &lt;dbl&gt;, host_is_superhost &lt;lgl&gt;,
## #   host_total_listings_count &lt;dbl&gt;, host_verifications &lt;chr&gt;,
## #   host_identity_verified &lt;lgl&gt;, neighborhood &lt;chr&gt;, borough &lt;chr&gt;,
## #   zipcode &lt;dbl&gt;, property_type &lt;fct&gt;, accommodates &lt;dbl&gt;,
## #   bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;, bed_type &lt;chr&gt;,
## #   price &lt;dbl&gt;, security_deposit &lt;dbl&gt;, cleaning_fee &lt;dbl&gt;,
## #   guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;, minimum_nights &lt;dbl&gt;,
## #   calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;</code></pre>
<p>Example: Return a dataframe with only those rows where the price is more than 8000.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">filter</span>(df, price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 44
##       id listing_url name  description host_id host_name host_since
##    &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
## 1 9.53e6 https://ww~ Quie~ This priva~ 3906464 Amy       2012-10-17
## 2 1.39e7 https://ww~ Luxu~ Our luxury~ 5143901 Erin      2013-02-19
## 3 4.74e6 https://ww~ Span~ 4 minute w~ 1235070 Olson     2011-10-01
## 4 7.00e6 https://ww~ Furn~ 1 room wit~ 205828~ Kathrine  2014-08-26
## 5 2.34e7 https://ww~ Beau~ The perfec~ 181284~ Rum       2014-07-15
## # ... with 37 more variables: host_response_time &lt;chr&gt;,
## #   host_response_rate &lt;dbl&gt;, host_is_superhost &lt;lgl&gt;,
## #   host_total_listings_count &lt;dbl&gt;, host_verifications &lt;chr&gt;,
## #   host_identity_verified &lt;lgl&gt;, neighborhood &lt;chr&gt;, borough &lt;chr&gt;,
## #   zipcode &lt;dbl&gt;, property_type &lt;fct&gt;, accommodates &lt;dbl&gt;,
## #   bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;, bed_type &lt;chr&gt;,
## #   price &lt;dbl&gt;, security_deposit &lt;dbl&gt;, cleaning_fee &lt;dbl&gt;,
## #   guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;, minimum_nights &lt;dbl&gt;,
## #   calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;</code></pre>
<p>You can combine multiple conditions.</p>
<p>Example: Return a dataframe with rows where the borough is Manhattan and the price is less than 50.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">filter</span>(df, borough <span class="op">==</span><span class="st"> &quot;Manhattan&quot;</span>, price <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span>)</a></code></pre></div>
<pre><code>## # A tibble: 520 x 44
##        id listing_url name  description host_id host_name host_since
##     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
##  1 3.27e7 https://ww~ Slee~ Traveling ~ 163749~ Brianna   2017-12-22
##  2 3.50e7 https://ww~ Big ~ My beautif~ 19342   Rivka     2009-05-29
##  3 2.18e7 https://ww~ Priv~ Come stay ~ 5742326 Dina      2013-04-02
##  4 1.40e7 https://ww~ Room~ My place i~ 759164~ Juan      2016-06-05
##  5 2.97e7 https://ww~ New ~ Traveling ~ 223248~ Julia     2018-10-29
##  6 3.41e7 https://ww~ Clea~ This listi~ 427679~ Shara     2015-08-28
##  7 8.34e5 https://ww~ Larg~ Great reno~ 4112404 Vero      2012-11-10
##  8 2.19e7 https://ww~ Spac~ Spacious a~ 505228~ Nora      2015-12-04
##  9 3.06e6 https://ww~ Furn~ $1035/mont~ 7101220 David     2013-06-25
## 10 5.36e6 https://ww~ Beau~ A spacious~ 277906~ Carl      2015-02-15
## # ... with 510 more rows, and 37 more variables: host_response_time &lt;chr&gt;,
## #   host_response_rate &lt;dbl&gt;, host_is_superhost &lt;lgl&gt;,
## #   host_total_listings_count &lt;dbl&gt;, host_verifications &lt;chr&gt;,
## #   host_identity_verified &lt;lgl&gt;, neighborhood &lt;chr&gt;, borough &lt;chr&gt;,
## #   zipcode &lt;dbl&gt;, property_type &lt;fct&gt;, accommodates &lt;dbl&gt;,
## #   bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;, bed_type &lt;chr&gt;,
## #   price &lt;dbl&gt;, security_deposit &lt;dbl&gt;, cleaning_fee &lt;dbl&gt;,
## #   guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;, minimum_nights &lt;dbl&gt;,
## #   calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;</code></pre>
<p>Example: Return a dataframe with rows where cancellation_policy is flexible <em>or</em> accommodates more than 2.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">filter</span>(df, cancellation_policy <span class="op">==</span><span class="st"> &quot;flexible&quot;</span> <span class="op">|</span><span class="st"> </span>accommodates <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> )</a></code></pre></div>
<pre><code>## # A tibble: 21,439 x 44
##        id listing_url name  description host_id host_name host_since
##     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
##  1 1.93e6 https://ww~ Subl~ $490/week.~ 2765870 Amarie21~ 2012-06-27
##  2 4.24e6 https://ww~ Sunn~ It&#39;s a sma~ 782008  Lori      2011-07-05
##  3 8.81e6 https://ww~ Spac~ Loft room ~ 133181~ Rebecca   2014-03-19
##  4 9.21e6 https://ww~ Clea~ Its a spar~ 478863~ Megan     2015-11-01
##  5 9.35e6 https://ww~ Cute~ This is a ~ 393330~ XiWei     2015-07-23
##  6 9.73e6 https://ww~ 2nd ~ Comfortabl~ 149742~ Gabriel   2014-05-01
##  7 1.40e7 https://ww~ Cozy~ My place i~ 834766~ Carmen    2016-07-13
##  8 1.42e7 https://ww~ Peac~ &quot;I will be~ 3602785 James     2012-09-18
##  9 1.62e7 https://ww~ 1 Be~ The Wyndha~ 695458~ Chayla    2016-04-29
## 10 1.90e7 https://ww~ Bush~ A cute com~ 604942~ Breanna   2016-02-26
## # ... with 21,429 more rows, and 37 more variables:
## #   host_response_time &lt;chr&gt;, host_response_rate &lt;dbl&gt;,
## #   host_is_superhost &lt;lgl&gt;, host_total_listings_count &lt;dbl&gt;,
## #   host_verifications &lt;chr&gt;, host_identity_verified &lt;lgl&gt;,
## #   neighborhood &lt;chr&gt;, borough &lt;chr&gt;, zipcode &lt;dbl&gt;, property_type &lt;fct&gt;,
## #   accommodates &lt;dbl&gt;, bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;,
## #   bed_type &lt;chr&gt;, price &lt;dbl&gt;, security_deposit &lt;dbl&gt;,
## #   cleaning_fee &lt;dbl&gt;, guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;,
## #   minimum_nights &lt;dbl&gt;, calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;</code></pre>
<p>Example: Return a dataframe with rows where number_of_reviews is <em>not</em> 0</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">filter</span>(df, number_of_reviews <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## # A tibble: 37,762 x 44
##        id listing_url name  description host_id host_name host_since
##     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
##  1 1.93e6 https://ww~ Subl~ $490/week.~ 2765870 Amarie21~ 2012-06-27
##  2 4.24e6 https://ww~ Sunn~ It&#39;s a sma~ 782008  Lori      2011-07-05
##  3 6.03e6 https://ww~ Priv~ - Private ~ 6396863 Tianhui   2013-05-14
##  4 6.89e6 https://ww~ Priv~ Our Hamilt~ 110810~ Rob       2014-01-06
##  5 8.81e6 https://ww~ Spac~ Loft room ~ 133181~ Rebecca   2014-03-19
##  6 9.21e6 https://ww~ Clea~ Its a spar~ 478863~ Megan     2015-11-01
##  7 9.35e6 https://ww~ Cute~ This is a ~ 393330~ XiWei     2015-07-23
##  8 9.51e6 https://ww~ Apar~ I only ren~ 492863~ Tairan    2015-11-17
##  9 9.73e6 https://ww~ 2nd ~ Comfortabl~ 149742~ Gabriel   2014-05-01
## 10 1.40e7 https://ww~ Cozy~ My place i~ 834766~ Carmen    2016-07-13
## # ... with 37,752 more rows, and 37 more variables:
## #   host_response_time &lt;chr&gt;, host_response_rate &lt;dbl&gt;,
## #   host_is_superhost &lt;lgl&gt;, host_total_listings_count &lt;dbl&gt;,
## #   host_verifications &lt;chr&gt;, host_identity_verified &lt;lgl&gt;,
## #   neighborhood &lt;chr&gt;, borough &lt;chr&gt;, zipcode &lt;dbl&gt;, property_type &lt;fct&gt;,
## #   accommodates &lt;dbl&gt;, bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;,
## #   bed_type &lt;chr&gt;, price &lt;dbl&gt;, security_deposit &lt;dbl&gt;,
## #   cleaning_fee &lt;dbl&gt;, guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;,
## #   minimum_nights &lt;dbl&gt;, calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;</code></pre>
<p>Note: when multiple conditions are separated by commas, the conditions are assumed to have <em>and</em> logical operator between them. Using <code>&amp;</code> instead would be the same thing. For <em>or</em> and other logical operators, we have to explicitly use the appropriate logical operator (e.g.¬†<code>|</code> for <em>or</em>).</p>
<p>üèè Return a dataframe with rows where number of bedrooms is not 1 and property_type is House</p>
<p>üèè Return a dataframe with rows where host_response_time is within an hour or host_response_rate is more than 90% or calendar was updated today</p>
</div>
<div id="verb-select" class="section level3">
<h3>Verb: select</h3>
<p>Our second verb is <code>select</code>, which is used to return a subset of the columns.</p>
<p>The syntax is: <code>select(name_of_dataframe, name_of_column1, name_of_column2, ...)</code></p>
<p>There are some variations to this syntax, which come in handy in certain situations.</p>
<ul>
<li>If you want all columns except one: <code>select(name_of_dataframe, -column_to_exclude)</code></li>
<li>If you want all columns except two: <code>select(name_of_dataframe, -c(column_to_exlude1, column_to_exclue2))</code></li>
<li>If you want the third through eighth columns: <code>select(name_of_dataframe, 3:8)</code></li>
</ul>
<p>Example: Return a dataframe with only the listing_url column.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">select</span>(df, listing_url)</a></code></pre></div>
<pre><code>## # A tibble: 37,762 x 1
##    listing_url                          
##    &lt;chr&gt;                                
##  1 https://www.airbnb.com/rooms/1925519 
##  2 https://www.airbnb.com/rooms/4244476 
##  3 https://www.airbnb.com/rooms/6031895 
##  4 https://www.airbnb.com/rooms/6887405 
##  5 https://www.airbnb.com/rooms/8807842 
##  6 https://www.airbnb.com/rooms/9207023 
##  7 https://www.airbnb.com/rooms/9345523 
##  8 https://www.airbnb.com/rooms/9511685 
##  9 https://www.airbnb.com/rooms/9732432 
## 10 https://www.airbnb.com/rooms/13987276
## # ... with 37,752 more rows</code></pre>
<p>Example: Return a dataframe with columns host_response_time, cancellation_policy, and neighborhood.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">select</span>(df, host_response_time, cancellation_policy, neighborhood)</a></code></pre></div>
<pre><code>## # A tibble: 37,762 x 3
##    host_response_time cancellation_policy neighborhood    
##    &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;           
##  1 N/A                flexible            Lower East Side 
##  2 N/A                flexible            Greenpoint      
##  3 N/A                moderate            Theater District
##  4 N/A                moderate            Harlem          
##  5 N/A                flexible            Williamsburg    
##  6 N/A                flexible            Midwood         
##  7 N/A                flexible            East Village    
##  8 N/A                moderate            Stuyvesant Town 
##  9 N/A                flexible            Bushwick        
## 10 N/A                flexible            Harlem          
## # ... with 37,752 more rows</code></pre>
<p>Example: Return a dataframe with second through fourth columns</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">select</span>(df, <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## # A tibble: 37,762 x 3
##    listing_url           name              description                     
##    &lt;chr&gt;                 &lt;chr&gt;             &lt;chr&gt;                           
##  1 https://www.airbnb.c~ Sublet: $490/Wk   $490/week. Huge 1 bedroom / 2bd~
##  2 https://www.airbnb.c~ Sunny and Funky ~ It&#39;s a smaller room with an des~
##  3 https://www.airbnb.c~ Private Bedroom ~ - Private bedroom in 2 person a~
##  4 https://www.airbnb.c~ Private Room in ~ Our Hamilton Heights 3BR featur~
##  5 https://www.airbnb.c~ Spacious arty lo~ Loft room in a spacious apartme~
##  6 https://www.airbnb.c~ Clean private ro~ Its a spare bedroom with lots o~
##  7 https://www.airbnb.c~ Cute Private Bed~ This is a private bedroom in a ~
##  8 https://www.airbnb.c~ Apartment in Stu~ I only rent my room for my apar~
##  9 https://www.airbnb.c~ 2nd floor bedroo~ Comfortable bedroom in a recent~
## 10 https://www.airbnb.c~ Cozy, two bedroo~ My place is close to Harlem Pub~
## # ... with 37,752 more rows</code></pre>
<p>üèè Return a dataframe with property_type, room_type, and zip_code columns.</p>
<p>üèè Return a dataframe with the last 23 columns (sixth through 28th)</p>
<p>üèè What would be another way of getting the same dataframe?</p>
</div>
<div id="piping" class="section level3">
<h3>Piping</h3>
<p>Before I introduce the third verb, let‚Äôs take another detour.</p>
<p>You can‚Äôt accomplish a lot with <code>filter</code> and <code>select</code> in isolation. Let‚Äôs combine them.</p>
<p>Here, we‚Äôre creating a new dataframe <code>df_expensive</code> by using <code>filter</code> and then we‚Äôre selecting some columns of interest from that dataframe.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">df_expensive &lt;-<span class="st"> </span><span class="kw">filter</span>(df, price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">select</span>(df_expensive, price, neighborhood, listing_url)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   price neighborhood    listing_url                          
##   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;                                
## 1  9999 Lower East Side https://www.airbnb.com/rooms/9528920 
## 2 10000 Greenpoint      https://www.airbnb.com/rooms/13894339
## 3  9999 East Harlem     https://www.airbnb.com/rooms/4737930 
## 4 10000 Astoria         https://www.airbnb.com/rooms/7003697 
## 5  8500 Tribeca         https://www.airbnb.com/rooms/23377410</code></pre>
<p>ü§î More than $8000 per night? What‚Äôs going on here? How can we find out more? What should we do with this kind of outliers?</p>
<p>The above code could be written more succinctly by using pipe <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="st">  </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="st">  </span><span class="kw">select</span>(price, neighborhood, listing_url)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   price neighborhood    listing_url                          
##   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;                                
## 1  9999 Lower East Side https://www.airbnb.com/rooms/9528920 
## 2 10000 Greenpoint      https://www.airbnb.com/rooms/13894339
## 3  9999 East Harlem     https://www.airbnb.com/rooms/4737930 
## 4 10000 Astoria         https://www.airbnb.com/rooms/7003697 
## 5  8500 Tribeca         https://www.airbnb.com/rooms/23377410</code></pre>
<p>Let‚Äôs try to understand how the pipe works.</p>
<p><code>filter</code> and <code>select</code> both receive a dataframe as their first parameter (this is true for the other four main verbs as well.) Also, you may have noticed that <code>filter</code> and <code>select</code> return a dataframe (again, it‚Äôs true for the others as well). Thanks to this, we can use the pipe to string together several verbs to form a complex query.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">filter</span>(df, price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 44
##       id listing_url name  description host_id host_name host_since
##    &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
## 1 9.53e6 https://ww~ Quie~ This priva~ 3906464 Amy       2012-10-17
## 2 1.39e7 https://ww~ Luxu~ Our luxury~ 5143901 Erin      2013-02-19
## 3 4.74e6 https://ww~ Span~ 4 minute w~ 1235070 Olson     2011-10-01
## 4 7.00e6 https://ww~ Furn~ 1 room wit~ 205828~ Kathrine  2014-08-26
## 5 2.34e7 https://ww~ Beau~ The perfec~ 181284~ Rum       2014-07-15
## # ... with 37 more variables: host_response_time &lt;chr&gt;,
## #   host_response_rate &lt;dbl&gt;, host_is_superhost &lt;lgl&gt;,
## #   host_total_listings_count &lt;dbl&gt;, host_verifications &lt;chr&gt;,
## #   host_identity_verified &lt;lgl&gt;, neighborhood &lt;chr&gt;, borough &lt;chr&gt;,
## #   zipcode &lt;dbl&gt;, property_type &lt;fct&gt;, accommodates &lt;dbl&gt;,
## #   bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;, bed_type &lt;chr&gt;,
## #   price &lt;dbl&gt;, security_deposit &lt;dbl&gt;, cleaning_fee &lt;dbl&gt;,
## #   guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;, minimum_nights &lt;dbl&gt;,
## #   calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;</code></pre>
<p>is the same as</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 44
##       id listing_url name  description host_id host_name host_since
##    &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
## 1 9.53e6 https://ww~ Quie~ This priva~ 3906464 Amy       2012-10-17
## 2 1.39e7 https://ww~ Luxu~ Our luxury~ 5143901 Erin      2013-02-19
## 3 4.74e6 https://ww~ Span~ 4 minute w~ 1235070 Olson     2011-10-01
## 4 7.00e6 https://ww~ Furn~ 1 room wit~ 205828~ Kathrine  2014-08-26
## 5 2.34e7 https://ww~ Beau~ The perfec~ 181284~ Rum       2014-07-15
## # ... with 37 more variables: host_response_time &lt;chr&gt;,
## #   host_response_rate &lt;dbl&gt;, host_is_superhost &lt;lgl&gt;,
## #   host_total_listings_count &lt;dbl&gt;, host_verifications &lt;chr&gt;,
## #   host_identity_verified &lt;lgl&gt;, neighborhood &lt;chr&gt;, borough &lt;chr&gt;,
## #   zipcode &lt;dbl&gt;, property_type &lt;fct&gt;, accommodates &lt;dbl&gt;,
## #   bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;, bed_type &lt;chr&gt;,
## #   price &lt;dbl&gt;, security_deposit &lt;dbl&gt;, cleaning_fee &lt;dbl&gt;,
## #   guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;, minimum_nights &lt;dbl&gt;,
## #   calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;</code></pre>
<p>Similarly,</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">select</span>(df, price, review_scores_rating, listing_url)</a></code></pre></div>
<pre><code>## # A tibble: 37,762 x 3
##    price review_scores_rating listing_url                          
##    &lt;dbl&gt;                &lt;dbl&gt; &lt;chr&gt;                                
##  1    80                   20 https://www.airbnb.com/rooms/1925519 
##  2    75                   20 https://www.airbnb.com/rooms/4244476 
##  3    60                   20 https://www.airbnb.com/rooms/6031895 
##  4    50                   20 https://www.airbnb.com/rooms/6887405 
##  5    50                   20 https://www.airbnb.com/rooms/8807842 
##  6    50                   20 https://www.airbnb.com/rooms/9207023 
##  7    85                   20 https://www.airbnb.com/rooms/9345523 
##  8    80                   20 https://www.airbnb.com/rooms/9511685 
##  9    35                   20 https://www.airbnb.com/rooms/9732432 
## 10   150                   20 https://www.airbnb.com/rooms/13987276
## # ... with 37,752 more rows</code></pre>
<p>is the same as</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(price, review_scores_rating, listing_url)</a></code></pre></div>
<pre><code>## # A tibble: 37,762 x 3
##    price review_scores_rating listing_url                          
##    &lt;dbl&gt;                &lt;dbl&gt; &lt;chr&gt;                                
##  1    80                   20 https://www.airbnb.com/rooms/1925519 
##  2    75                   20 https://www.airbnb.com/rooms/4244476 
##  3    60                   20 https://www.airbnb.com/rooms/6031895 
##  4    50                   20 https://www.airbnb.com/rooms/6887405 
##  5    50                   20 https://www.airbnb.com/rooms/8807842 
##  6    50                   20 https://www.airbnb.com/rooms/9207023 
##  7    85                   20 https://www.airbnb.com/rooms/9345523 
##  8    80                   20 https://www.airbnb.com/rooms/9511685 
##  9    35                   20 https://www.airbnb.com/rooms/9732432 
## 10   150                   20 https://www.airbnb.com/rooms/13987276
## # ... with 37,752 more rows</code></pre>
<p>The left side of the pipe is used as the first parameter of the function on the right side of the pipe.</p>
<p>This is how <code>filter</code>, <code>select</code>, and such functions receive a dataframe, do something to it, return the modified dataframe and passes it on to the next function.</p>
<p>Here‚Äôs again the piped expression. Make sure you understand what‚Äôs going on.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="st">  </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="st">  </span><span class="kw">select</span>(price, review_scores_rating, listing_url)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   price review_scores_rating listing_url                          
##   &lt;dbl&gt;                &lt;dbl&gt; &lt;chr&gt;                                
## 1  9999                   87 https://www.airbnb.com/rooms/9528920 
## 2 10000                   92 https://www.airbnb.com/rooms/13894339
## 3  9999                  100 https://www.airbnb.com/rooms/4737930 
## 4 10000                  100 https://www.airbnb.com/rooms/7003697 
## 5  8500                  100 https://www.airbnb.com/rooms/23377410</code></pre>
</div>
<div id="verb-arrange" class="section level3">
<h3>Verb: arrange</h3>
<p><code>arrange</code> is our third verb. (Note that I‚Äôm using verb and function interchangeably.) <code>arrange</code> sorts a dataframe based on the values of one or more columns.</p>
<p>Example: Get the same dataframe as the last code chunk. Sort it by price.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="st">  </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="st">  </span><span class="kw">select</span>(price, review_scores_rating, listing_url) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(price)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   price review_scores_rating listing_url                          
##   &lt;dbl&gt;                &lt;dbl&gt; &lt;chr&gt;                                
## 1  8500                  100 https://www.airbnb.com/rooms/23377410
## 2  9999                   87 https://www.airbnb.com/rooms/9528920 
## 3  9999                  100 https://www.airbnb.com/rooms/4737930 
## 4 10000                   92 https://www.airbnb.com/rooms/13894339
## 5 10000                  100 https://www.airbnb.com/rooms/7003697</code></pre>
<p>Example: The same dataframe, but now in descending order of price.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="st">  </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="st">  </span><span class="kw">select</span>(price, review_scores_rating, listing_url) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb66-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(price))</a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   price review_scores_rating listing_url                          
##   &lt;dbl&gt;                &lt;dbl&gt; &lt;chr&gt;                                
## 1 10000                   92 https://www.airbnb.com/rooms/13894339
## 2 10000                  100 https://www.airbnb.com/rooms/7003697 
## 3  9999                   87 https://www.airbnb.com/rooms/9528920 
## 4  9999                  100 https://www.airbnb.com/rooms/4737930 
## 5  8500                  100 https://www.airbnb.com/rooms/23377410</code></pre>
<p>Example: You can add more columns to <code>arrange</code>. Now when price is the same, the order will be based on neighborhood.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="st">  </span><span class="kw">filter</span>(price <span class="op">&gt;</span><span class="st"> </span><span class="dv">8000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="st">  </span><span class="kw">select</span>(price, neighborhood, listing_url) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(price), neighborhood)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   price neighborhood    listing_url                          
##   &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;                                
## 1 10000 Astoria         https://www.airbnb.com/rooms/7003697 
## 2 10000 Greenpoint      https://www.airbnb.com/rooms/13894339
## 3  9999 East Harlem     https://www.airbnb.com/rooms/4737930 
## 4  9999 Lower East Side https://www.airbnb.com/rooms/9528920 
## 5  8500 Tribeca         https://www.airbnb.com/rooms/23377410</code></pre>
<p>üèè Return the whole dataframe <code>df</code>, in descending order of number of bedrooms and where number of bedrooms are equal, descending order of review_scores_rating</p>
</div>
<div id="verb-mutate" class="section level3">
<h3>Verb: mutate</h3>
<p><code>mutate</code> creates a new column by modifying one or more existing columns. It‚Äôs better explained by examples.</p>
<p>Example:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">mutate</span>(df, <span class="dt">price_per_person =</span> price <span class="op">/</span><span class="st"> </span>accommodates)</a></code></pre></div>
<pre><code>## # A tibble: 37,762 x 45
##        id listing_url name  description host_id host_name host_since
##     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;     &lt;date&gt;    
##  1 1.93e6 https://ww~ Subl~ $490/week.~ 2765870 Amarie21~ 2012-06-27
##  2 4.24e6 https://ww~ Sunn~ It&#39;s a sma~ 782008  Lori      2011-07-05
##  3 6.03e6 https://ww~ Priv~ - Private ~ 6396863 Tianhui   2013-05-14
##  4 6.89e6 https://ww~ Priv~ Our Hamilt~ 110810~ Rob       2014-01-06
##  5 8.81e6 https://ww~ Spac~ Loft room ~ 133181~ Rebecca   2014-03-19
##  6 9.21e6 https://ww~ Clea~ Its a spar~ 478863~ Megan     2015-11-01
##  7 9.35e6 https://ww~ Cute~ This is a ~ 393330~ XiWei     2015-07-23
##  8 9.51e6 https://ww~ Apar~ I only ren~ 492863~ Tairan    2015-11-17
##  9 9.73e6 https://ww~ 2nd ~ Comfortabl~ 149742~ Gabriel   2014-05-01
## 10 1.40e7 https://ww~ Cozy~ My place i~ 834766~ Carmen    2016-07-13
## # ... with 37,752 more rows, and 38 more variables:
## #   host_response_time &lt;chr&gt;, host_response_rate &lt;dbl&gt;,
## #   host_is_superhost &lt;lgl&gt;, host_total_listings_count &lt;dbl&gt;,
## #   host_verifications &lt;chr&gt;, host_identity_verified &lt;lgl&gt;,
## #   neighborhood &lt;chr&gt;, borough &lt;chr&gt;, zipcode &lt;dbl&gt;, property_type &lt;fct&gt;,
## #   accommodates &lt;dbl&gt;, bathrooms &lt;dbl&gt;, bedrooms &lt;dbl&gt;, beds &lt;dbl&gt;,
## #   bed_type &lt;chr&gt;, price &lt;dbl&gt;, security_deposit &lt;dbl&gt;,
## #   cleaning_fee &lt;dbl&gt;, guests_included &lt;dbl&gt;, extra_people &lt;dbl&gt;,
## #   minimum_nights &lt;dbl&gt;, calendar_updated &lt;chr&gt;, has_availability &lt;lgl&gt;,
## #   availability_365 &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;,
## #   number_of_reviews_ltm &lt;dbl&gt;, review_scores_rating &lt;dbl&gt;,
## #   review_scores_accuracy &lt;dbl&gt;, review_scores_cleanliness &lt;dbl&gt;,
## #   review_scores_checkin &lt;dbl&gt;, review_scores_communication &lt;dbl&gt;,
## #   review_scores_location &lt;dbl&gt;, review_scores_value &lt;dbl&gt;,
## #   instant_bookable &lt;lgl&gt;, is_business_travel_ready &lt;lgl&gt;,
## #   cancellation_policy &lt;chr&gt;, reviews_per_month &lt;dbl&gt;,
## #   price_per_person &lt;dbl&gt;</code></pre>
<p>üèè Create a new review_rating column, which is an average of review_scores_accuracy and review_scores_value.</p>
</div>
<div id="verb-summarize-or-summarise" class="section level3">
<h3>Verb: summarize (or summarise)</h3>
<p><code>summarize</code>, as you‚Äôd expect, gives some kind of summary (such as mean, median, min, max) of the values of a given column.</p>
<p>Example: What is the total number of people that can stay in NYC Airbnbs?</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">summarize</span>(df, <span class="dt">total_accommodates =</span> <span class="kw">sum</span>(accommodates))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   total_accommodates
##                &lt;dbl&gt;
## 1             109531</code></pre>
<p>Here, total_accommodates is a name I‚Äôve given to the summary number.</p>
<p>The common summary functions are: - sum - n (count) - mean - median - sd (standard deviation) - var (variance) - range - min - max</p>
<p>Note: The function <code>n</code> doesn‚Äôt need a parameter because it just counts the number of rows in the dataframe. This would become more clear in the examples.</p>
<p>We can also write our own function and use here. But that is a more advanced topic.</p>
<p>Example: What is the mean rating for accuracy</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">summarize</span>(df, <span class="dt">mean_accuracy =</span> <span class="kw">mean</span>(review_scores_accuracy))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   mean_accuracy
##           &lt;dbl&gt;
## 1            NA</code></pre>
<p>Hmm, not exactly what we expected. This is because any arithmetic operation involving <code>NA</code> (that is, <em>Not Available</em> or missing values) results in <code>NA</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="ot">NA</span></a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>Or,</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="ot">NA</span> <span class="op">/</span><span class="st"> </span><span class="dv">33</span></a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>The review_scores_accuracy had several <code>NA</code>s. The correct way of doing this would be:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">summarize</span>(df, <span class="dt">mean_accuracy =</span> <span class="kw">mean</span>(review_scores_accuracy, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   mean_accuracy
##           &lt;dbl&gt;
## 1          9.62</code></pre>
<p><code>na.rm = TRUE</code> means ‚Äúremove all NAs before performing arithmetic operations.‚Äù</p>
<p>When we summed the accommodates column earlier, we didn‚Äôt add <code>na.rm = TRUE</code> because that column didn‚Äôt have any NAs.</p>
<p>Example: We can have multiple summaries at the same time.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">summarize</span>(df, <span class="dt">min_score_value =</span> <span class="kw">min</span>(review_scores_value, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb82-2" title="2">          <span class="dt">max_score_value =</span> <span class="kw">max</span>(review_scores_value, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   min_score_value max_score_value
##             &lt;dbl&gt;           &lt;dbl&gt;
## 1               2              10</code></pre>
<p>Example: What‚Äôs the total number of listings in this dataset?</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count =</span> <span class="kw">n</span>())</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   count
##   &lt;int&gt;
## 1 37762</code></pre>
<p>üèè The host who‚Äôs been with Airbnb NYC for the longest time started on which date?</p>
<p>üèè Find the standard deviation and mean of the price variable.</p>
<p>üèè Count the number of unique zip_codes in the data. Hint <code>distinct</code> and <code>n</code>.</p>
<p>üèè How many listings have perfect 100 for review_scores_rating (which is the overall rating shown as stars on the listing‚Äôs webpage)?</p>
<p>üèè How many listings have a perfect 100 of review_scores_rating and cost less than 50?</p>
</div>
<div id="verb-group_by" class="section level3">
<h3>Verb: group_by</h3>
<p><code>group_by</code> is one of the most useful functions. It divides the data into different groups and then <code>summarize</code> summarizes each of the groups. This way, we can compare the different groups on various attributes.</p>
<p>Example: What‚Äôs the mean and median price in each of the five boroughs?</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(borough) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">mean</span>(price), <span class="kw">median</span>(price))</a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   borough       `mean(price)` `median(price)`
##   &lt;chr&gt;                 &lt;dbl&gt;           &lt;dbl&gt;
## 1 Bronx                  80.5              64
## 2 Brooklyn              121.               95
## 3 Manhattan             178.              140
## 4 Queens                 95.1              71
## 5 Staten Island          89.3              75</code></pre>
<p>üèè Return the same dataframe but sorted by mean price.</p>
<p>Example: Which are the top 10 neighborhoods by total number of listings?</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(neighborhood) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(count))</a></code></pre></div>
<pre><code>## Selecting by count</code></pre>
<pre><code>## # A tibble: 10 x 2
##    neighborhood       count
##    &lt;chr&gt;              &lt;int&gt;
##  1 Bedford-Stuyvesant  3090
##  2 Williamsburg        3082
##  3 Harlem              2155
##  4 Bushwick            1865
##  5 Hell&#39;s Kitchen      1476
##  6 East Village        1453
##  7 Upper West Side     1402
##  8 Upper East Side     1317
##  9 Crown Heights       1250
## 10 Midtown              929</code></pre>
<p>We introduce a new function <code>top_n</code> here, which returns top n rows (or bottom n rows, when n is negative) ordered by some variable. In the code chunk above, if we had <code>top_n(-10)</code>, we would‚Äôve got the bottom 10 rows.</p>
<p>Example: Which are the top two neighborhoods in each of the boroughs by number of listings?</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(borough, neighborhood) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(count))</a></code></pre></div>
<pre><code>## Selecting by count</code></pre>
<pre><code>## # A tibble: 10 x 3
## # Groups:   borough [5]
##    borough       neighborhood       count
##    &lt;chr&gt;         &lt;chr&gt;              &lt;int&gt;
##  1 Brooklyn      Bedford-Stuyvesant  3090
##  2 Brooklyn      Williamsburg        3082
##  3 Manhattan     Harlem              2155
##  4 Manhattan     Hell&#39;s Kitchen      1476
##  5 Queens        Astoria              696
##  6 Queens        Long Island City     417
##  7 Bronx         Kingsbridge           54
##  8 Bronx         Mott Haven            51
##  9 Staten Island St. George            42
## 10 Staten Island Tompkinsville         42</code></pre>
<p>üèè Do the same as above but only for listings where price is more than 500 and property_type is Apartment.</p>
<p>Example: In Manhattan, which neighborhood has the highest mean price?*</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">filter</span>(borough <span class="op">==</span><span class="st"> &quot;Manhattan&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(neighborhood) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_price =</span> <span class="kw">mean</span>(price)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(mean_price))</a></code></pre></div>
<pre><code>## # A tibble: 32 x 2
##    neighborhood       mean_price
##    &lt;chr&gt;                   &lt;dbl&gt;
##  1 Tribeca                  462.
##  2 NoHo                     297.
##  3 Flatiron District        296.
##  4 SoHo                     262.
##  5 Midtown                  258.
##  6 West Village             245.
##  7 Financial District       236.
##  8 Greenwich Village        234.
##  9 Theater District         231.
## 10 Nolita                   227.
## # ... with 22 more rows</code></pre>
<p>üèè In Bronx and Queens, what‚Äôs the mean price for different property_type?</p>
<p>üèè For each borough, which neighborhood has the highest variance in price?</p>
<p>üèè Which combination of property_type and room_type has the highest median price?</p>
<p>üèè Considering only the Brooklyn listings that have review_scores_value 9 or 10, which neighborhood, out of those neighborhoods with at least 100 listings, has the lowest median price?</p>
</div>
</div>
</div>
<div id="explore-visually" class="section level1">
<h1>Explore Visually</h1>
<p>We‚Äôre going to use the ggplot2 package, which we loaded earlier, for some visual exploration of the data. Actually, this is how we should have begun our data exploration. We couldn‚Äôt do this because we needed to learn the six verbs first to get the full benefit of ggplot2.</p>
<p>Unfortunately, we won‚Äôt have time today to learn ggplot2. It may be possible to organize a separate session later on visualization in R.</p>
<p>Example: What‚Äôs the distribution of price?</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">ggplot</span>(df) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(price))</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-70-1.png" width="768" /></p>
<p>üèè What‚Äôs the problem with this histogram? How can we solve this?</p>
<p>Example: Compare price distribution of different boroughs.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="st">  </span><span class="kw">filter</span>(price <span class="op">&lt;</span><span class="st"> </span><span class="dv">500</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> price, <span class="dt">fill =</span> borough))</a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" width="768" /></p>
<p>Example: Do the same, but with boxplots</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="st">  </span><span class="kw">filter</span>(price <span class="op">&lt;</span><span class="st"> </span><span class="dv">500</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> borough, <span class="dt">y =</span> price))</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-73-1.png" width="768" /></p>
<p>Example: Which neighborhoods have the highest number Of listings that have review_scores_value less than 5.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="st">  </span><span class="kw">filter</span>(review_scores_value <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(borough, neighborhood) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-5" title="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-6" title="6"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(neighborhood, count), <span class="dt">y =</span> count)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-8" title="8"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<pre><code>## Selecting by count</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-74-1.png" width="768" /></p>
</div>
<div id="keep-learning" class="section level1">
<h1>Keep Learning</h1>
<p>If you like <code>dplyr</code> and the other tidyverse packages we used in this workshop, <a href="https://r4ds.had.co.nz">R for Data Science</a> is an excellent resource. Hadley Wickham, the author of the tidyverse packages, wrote that book.</p>
<p><a href="https://swirlstats.com">Swirl</a> is a unique tool ‚Äì it teaches you R and data science interactively right on the console. Follow the instructions <a href="https://swirlstats.com/students.html">here</a>.</p>
<p>To learn how to do statistics using R, you can watch <a href="https://www.youtube.com/watch?v=_V8eKsto3Ug">this YouTube video</a></p>
<p>To learn R‚Äôs programming concepts (which we didn‚Äôt cover in detail today), you can watch <a href="https://www.youtube.com/watch?v=fDRa82lxzaU">this YouTube video</a></p>
<p><a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.html">An Introduction to R</a> is perhaps the most comprehensive introduction. <em>But it‚Äôs not the best place to start if you‚Äôre a complete beginner.</em></p>
<div id="download-cheatsheets" class="section level2">
<h2>Download Cheatsheets</h2>
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/rstudio-ide.pdf">RStudio</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">Data transformation with dplyr</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf">Work with strings</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">Data import</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf">R Markdown</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/data-visualization-2.1.pdf">Data visualization with ggplot2</a></li>
<li></li>
</ul>
</div>
</div>
</div>


</div>

<div id="postamble" data-toggle="wy-nav-shift" class="status">
<p class="author"><span class="glyphicon glyphicon-user"></span> Asif Mehedi | Batten Institute</p>
<p class="date"><span class="glyphicon glyphicon-calendar"></span> Oct 3, 2019</p>
</div>


<script>
$(document).ready(function () {
 	    $('#content img')
 	  .addClass("image-lb");
  $('#content').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
	      delegate: 'img',
	      gallery: {enabled: true },
	      image: {
	        verticalFit: true,
          titleSrc: 'alt'
	      }
 	    });
 	});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
